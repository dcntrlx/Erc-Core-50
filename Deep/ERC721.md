# [ERC721](https://eips.ethereum.org/EIPS/eip-721): Non-Fungible Token Standard
**Created:** 2018-01-24
**Description:** A standard interface for non-fungible tokens(NFTs), also known as deeds. It provides basic functionality to track and transfer NFTs. It also provides functionality for allowance to manage NFTs on behalf of the owner. Allows appllications to work with any NFT through single interface.


- Every ERC-721 compliant contract must implement the ERC721 and [ERC165]("ERC165.md") interfaces
- Evety single NFT is identified by a unique ID: `uint256 _tokenId`
### ERC721 Interface
```solidity
pragma solidity ^0.4.20;
interface ERC721 /* is ERC165 */ {
    /// Emits when ownership of any NFT changes by any mechanism, except when a
    ///  contract initializes. Emits for transfer, destroyed and minted
    event Transfer(address indexed _from, address indexed _to, uint256 indexed _tokenId);

    /// Emits when the approved address for an NFT is changed or reaffirmed.
    /// The zero address indicates there is no approved address.
    event Approval(address indexed _owner, address indexed _approved, uint256 indexed _tokenId);

    /// Emits when an operator is enabled or disabled for an owner.
    /// The operator can manage all NFTs of the owner.
    event ApprovalForAll(address indexed _owner, address indexed _operator, bool _approved);

    /// Count all NFTs assigned to an owner.
    /// NFTs assigned to the zero address are considered invalid.
    function balanceOf(address _owner) external view returns (uint256);

    /// Find the owner of an NFT.
    /// NFTs assigned to zero address are considered invalid.
    function ownerOf(uint256 _tokenId) external view returns (address);

    /// Transfers the ownership of an NFT from one address to another address.
    /// When transfer is complete, this function checks if `_to` is a smart contract and calls `onERC721Received`.
    function safeTransferFrom(address _from, address _to, uint256 _tokenId, bytes data) external payable;

    /// Transfers the ownership of an NFT from one address to another address.
    /// This works identically to the other function with an extra data parameter, except this function just sets data to "".
    function safeTransferFrom(address _from, address _to, uint256 _tokenId) external payable;

    /// Transfer ownership of an NFT -- THE CALLER IS RESPONSIBLE TO CONFIRM THAT `_to` IS CAPABLE OF RECEIVING NFTS OR ELSE THEY MAY BE PERMANENTLY LOST.
    /// Throws unless `msg.sender` is the current owner, an authorized operator, or the approved address for this NFT.
    function transferFrom(address _from, address _to, uint256 _tokenId) external payable;

    /// Change or reaffirm the approved address for an NFT.
    /// The zero address indicates there is no approved address.
    function approve(address _approved, uint256 _tokenId) external payable;

    /// Enable or disable approval for a third party ("operator") to manage all of `msg.sender`'s assets.
    /// Emits the ApprovalForAll event.
    function setApprovalForAll(address _operator, bool _approved) external;

    /// Get the approved address for a single NFT.
    function getApproved(uint256 _tokenId) external view returns (address);

    /// Query if an address is an authorized operator for another address.
    function isApprovedForAll(address _owner, address _operator) external view returns (bool);
}
```

### ERC721TokenReceiver Interface
A wallet/broker/auction application MUST implement the wallet interface if it will accept safe transfers.

```solidity
interface ERC721TokenReceiver {
    /// Handle the receipt of an NFT.
    /// The ERC721 smart contract calls this function on the recipient after a `transfer`.
    /// Returns magic value showing that ERC721TokenReceiver interface is implemented: `bytes4(keccak256("onERC721Received(address,address,uint256,bytes)"))` unless throwing.
    function onERC721Received(address _operator, address _from, uint256 _tokenId, bytes _data) external returns(bytes4);
}
```

### ERC721Metadata (Optional)
The metadata extension is OPTIONAL for ERC-721 smart contracts. This allows your smart contract to be interrogated for its name and for other details about the assets which your NFTs represent.

```solidity
interface ERC721Metadata /* is ERC721 */ {
    /// Name for a collection of NFTs in this contract.
    function name() external view returns (string _name);

    /// An abbreviated name for NFTs in this contract.
    function symbol() external view returns (string _symbol);

    /// A distinct Uniform Resource Identifier (URI) for a given asset.
    /// Throws if `_tokenId` is not a valid NFT. URIs are defined in RFC 3986.
    /// The URI may point to a JSON file that conforms to the "ERC721 Metadata JSON Schema".
    function tokenURI(uint256 _tokenId) external view returns (string);
}
```

**ERC721 Metadata JSON Schema** Directly from the EIP
```json
{
    "title": "Asset Metadata",
    "type": "object",
    "properties": {
        "name": {
            "type": "string",
            "description": "Identifies the asset to which this NFT represents"
        },
        "description": {
            "type": "string",
            "description": "Describes the asset to which this NFT represents"
        },
        "image": {
            "type": "string",
            "description": "A URI pointing to a resource with mime type image/* representing the asset to which this NFT represents. Consider making any images at a width between 320 and 1080 pixels and aspect ratio between 1.91:1 and 4:5 inclusive."
        }
    }
}
```

### ERC721Enumerable (Optional)
The enumeration extension is OPTIONAL and allows your contract to publish its full list of NFTs and make them discoverable.

```solidity
interface ERC721Enumerable /* is ERC721 */ {
    /// Returns a count of valid NFTs tracked by this contract, where each one of them has an assigned and queryable owner not equal to the zero address.
    function totalSupply() external view returns (uint256);

    /// Enumerate valid NFTs.
    /// Throws if `_index` >= `totalSupply()`.
    /// Returns the token identifier for the `_index`th NFT (sort order not specified).
    function tokenByIndex(uint256 _index) external view returns (uint256);

    /// Enumerate NFTs assigned to an owner.
    /// Throws if `_index` >= `balanceOf(_owner)` or if `_owner` is the zero address, representing invalid NFTs.
    /// Returns the token identifier for the `_index`th NFT assigned to `_owner` (sort order not specified).
    function tokenOfOwnerByIndex(address _owner, uint256 _index) external view returns (uint256);
}

## Caveats (Solidity 0.4.20 Limitations)
- Because the standard used an old version, the interface code alone isn't enough. Implementations must follow these additional manual rules:
    - **Mutability:** Implementation must be at least as strict as the interface (e.g. `payable` -> `nonpayable`).
    - **Inheritance:** `ERC721Metadata`/`ERC721Enumerable` must implement `ERC721`. `ERC721` implements `ERC165`.
    - **Visibility:** `external` in spec can be `public` in implementation.

## Modern Solidity Adaptation
In modern Solidity (0.8.x+), these caveats are largely handled natively:
- **Mutability:** Strictly enforced by the compiler. You can override a function to be *more* restrictive (e.g., `view` implementation for a non-view interface function) but not less.
- **Visibility:** `external` in an interface can be implemented as `public` or `external`.

## Rationale
- **Identifiers:**
    - Unique `uint256` ID per contract.
    - Pair `(contract, tokenId)` is unique identifier for token on blockchain globally
    - IDs do not have sequential pattern and are not guaranteed to be sequential
- **Transfer Mechanism:**
    - **Safe:** `safeTransferFrom` (checks receiver compatibility).
    - **Unsafe:** `transferFrom`. dont checks receiver compatibility.
    - **Initiators:** Owner, Approved Address, or Operator.
- **Gas & Complexity:**
    - Implementations should avoid loops (e.g. in enumeration) to ensure scalability.

## Backwards Compatibility
- **ERC-20 Semantics:** Adopts `balanceOf`, `totalSupply`, `name`, `symbol`.
- **Decimals:** Optional. Returns `uint8(0)` if implemented, but not required.


- [OpenZeppelin ERC721](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/ERC721.sol)
