# ERC4494
Created: 2021-11
Description: An extension for ERC-721 that enables "gasless" approvals via EIP-712 signatures, similar to ERC-2612 for ERC-20.

## Core Concepts

### The Problem: Two-Step Friction
Just like with ERC-20, interacting with an NFT (e.g., listing it on a marketplace) requires two transactions:
1.  Approve: The user authorizes the marketplace to move the NFT (Costs gas).
2.  Action: The user (or marketplace) executes the trade.

This requires the user to have ETH and pay gas just to list an item.

### The Solution: Permit for NFTs
ERC-4494 brings the `permit` pattern to ERC-721.
1.  Sign: The owner signs a message off-chain authorizing a spender for a specific `tokenId`.
2.  Submit: A relayer (or the marketplace) submits the signature to the contract.
3.  Approve: The contract verifies the signature and sets the approval on-chain.

## Methods

### Permit
```solidity
function permit(address spender, uint256 tokenId, uint256 deadline, bytes memory sig) external;
```
spender: The address to be approved.
tokenId: The NFT ID.
deadline: Timestamp when the signature expires.
sig: The signature (supports both standard 65-byte and EIP-2098 compact 64-byte signatures).

### Nonces
```solidity
function nonces(uint256 tokenId) external view returns (uint256);
```
tokenId: The NFT ID.
Returns: The current nonce for the specific token.

### Domain Separator
```solidity
function DOMAIN_SEPARATOR() external view returns (bytes32);
```
Returns: The EIP-712 domain separator.

## Implementation Details

### Token-Specific Nonces
Unlike ERC-2612 (which tracks nonces per *owner*), ERC-4494 tracks nonces per *tokenId*.
-   Reason: An NFT is a unique object.
-   Increment: The nonce for a `tokenId` MUST be incremented every time the token is transferred. This ensures that old permits (signed by a previous owner) are invalidated automatically upon transfer.

### Signature Format
The standard explicitly supports `bytes memory sig` instead of separate `v, r, s` parameters. This allows for flexibility in signature schemes, specifically enabling EIP-2098 compact signatures.
