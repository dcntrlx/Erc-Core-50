# ERC137
Created: 2016-05
Description: The specification for the Ethereum Name Service (ENS), a distributed system for mapping human-readable names (like `alice.eth`) to machine-readable identifiers (addresses, content hashes, etc.).

## Core Concepts

### The Problem: Hex Strings
Ethereum addresses (`0x71C...976F`) are hard for humans to remember, type, and verify. This leads to lost funds and poor UX.

### The Solution: Namehash
ENS maps names to "nodes" (hashes).
-   **Namehash**: A recursive algorithm that converts a domain name into a fixed-length `bytes32` hash.
    -   `namehash('eth') = keccak256(node(root) + keccak256('eth'))`
    -   `namehash('alice.eth') = keccak256(node('eth') + keccak256('alice'))`
-   **Hierarchy**:
    -   **Mathematical Dependency**: `node('alice.eth')` is mathematically derived from `node('eth')`.
    -   **Permission Inheritance**: The Registry enforces that only the owner of the parent node can create subnodes (e.g., only owner of `eth` can create `alice.eth`).

## Methods

### Registry
The central contract that maintains the mapping of `node -> (owner, resolver, ttl)`.
```solidity
function owner(bytes32 node) constant returns (address);
function resolver(bytes32 node) constant returns (address);
function setOwner(bytes32 node, address owner);
function setSubnodeOwner(bytes32 node, bytes32 label, address owner);
function setResolver(bytes32 node, address resolver);
```
-   **setSubnodeOwner**: The critical function that allows the owner of `domain.eth` to create/sell `sub.domain.eth`.

### Resolver
The contract that actually holds the data (addresses, text records) for a name.
```solidity
function addr(bytes32 node) constant returns (address);
function supportsInterface(bytes4 interfaceID) constant returns (bool);
```
-   **addr**: Returns the Ethereum address associated with the name.

## Implementation Details

### Architecture 
1.  **Registry (Phonebook)**: The single source of truth. Stores Owner, Resolver, and TTL.
2.  **Resolver (Translator)**: Holds the actual records (Addr, Text). Registry points here.
3.  **Registrar (Manager)**: Controls allocation of domains (e.g., .eth).
4.  **Flow**: `Name` -> `Namehash` -> `Registry` (find Resolver) -> `Resolver` (find Address).

## Nuance & Risks
1.  **Squatting**: Early registrars (like the auction) were designed to prevent squatting, but it remains a challenge in open namespaces.
2.  **Phishing**: Homoglyph attacks (using look-alike characters) can trick users. Clients must normalize names (UTS-46) before hashing.
3.  **Resolver Trust**: If you use a malicious resolver, it could return a fake address for your name.

## Summary Comparison
-   **DNS**: Centralized, hierarchical, text-based.
-   **ENS**: Decentralized, hierarchical, hash-based.
