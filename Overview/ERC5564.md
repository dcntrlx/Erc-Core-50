# [ERC5564](https://eips.ethereum.org/EIPS/eip-5564)
Created: 2022-08-13
Description: A standard for generating Stealth Addresses. It allows a sender to create a unique, one-time address for a recipient that only the recipient can control, ensuring privacy by breaking the link between the receiver's identity and the transaction.

### Overview
In standard Ethereum, if Alice sends money to Bob, everyone sees `Alice -> Bob` on-chain.
With ERC-5564, Alice generates a unique "Stealth Address" that belongs to Bob, but nobody else knows it's Bob. The chain sees `Alice -> 0xRandomAddress`. Bob has the special key to unlock `0xRandomAddress`.

### The Meta Address
A "Meta Address" is a container that holds two distinct Public Keys. It looks like a long string (e.g., `st:eth:0x...`).

1. Spending Public Key (P_spend): Used to generate the final address that holds the money.
2. Viewing Public Key (P_view): Used only to generate the shared secret so Bob can find the transaction.

Why two? This allows Bob to give his "Viewing Key" to a third party (like a mobile app) to scan the blockchain for him without giving that server the power to steal his funds.

### How It Works (The Math)
> Sry for math, used nn's example to fit it.
The protocol uses Diffie-Hellman Key Exchange to let Alice and Bob agree on a secret number without ever meeting.

#### The Variables
- G: The Elliptic Curve Generator Point.
- Bob has: k_view (Private View Key) and P_view (Public View Key).
- Alice generates: r (Random Ephemeral Private Key) and R (Ephemeral Public Key).

#### The Calculation
1. Alice calculates the Shared Secret (S):
   S = r * P_view

2. Bob calculates the Shared Secret (S):
   S = k_view * R

Because `P_view = k_view * G` and `R = r * G`, both equations expand to `r * k_view * G`.
Both Alice and Bob now possess the exact same secret S. No one else can calculate it.

### Stealth addr genereation
Now that they have the Shared Secret (S), they derive the stealth address.
1. Hash the Secret:
   s_hash = Hash(S)
2. Derive the Stealth Public Key:
   P_stealth = P_spend + (s_hash * G)
3. Bob Claims it:
   Bob can generate the private key because he owns k_spend.
   k_stealth = k_spend + s_hash

### The Announcer Contract (The Bulletin Board)
Since the Stealth Address looks random to everyone we need a way to let receiver know that message is for him
The Announcer Contract is a simple public contract that acts like a bulletin board.
1. Sender sends the funds to the Stealth Address.
2. Sender calls the Announcer Contract to publish her ephemeral key (R).
3. Announcer emits an event.
4. Receiver's wallet listens to these events. He tries to unlock each one with his View Key.

- Meta-Address: A struct of `[PubKey_Spend, PubKey_View]`.
